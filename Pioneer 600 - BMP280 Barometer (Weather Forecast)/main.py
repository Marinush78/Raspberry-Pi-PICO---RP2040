from machine import Pin, I2C
from utime import sleep_ms
from BMP280 import BMP280
from SSD1306_I2C import OLED1306
import framebuf 


i2c = I2C(1, sda = Pin(2), scl = Pin(3), freq = 100000)
oled = OLED1306(i2c)
bmp = BMP280(i2c)


sunny = framebuf.FrameBuffer(bytearray(
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x80\x00\x00\x00\x00\x00\x00\x00\xf0\x00\x00\x00\x00\x00\x00\x00\x00'
    b'\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\xc0\x80\x00\x00\x00\x01\x03'
    b'\x84\xc0\x40\x60\x20\x30\x30\x31\x30\x30\x20\x60\x60\xc0\x84\x07\x00\x00\x00\x00\x80\xc0\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x00\x00\x80\x80\x80\x80\x80\x01\x01\x00\xf0\x3c\x06\x01\xe0\x30\x18\x0c\x04\x06\x06\x00\x00\x00\x00\x00\x00\x01\x03'
    b'\x3c\xf0\x00\x01\x01\x80\x80\x80\x80\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x80\x80\x00\x0f\x38\xe0'
    b'\x80\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\xc0\x38\x0f\x00\x80\x80\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x06\x02\x03\x01\x00\x00\x00\xc0\x43\x06\x06\x04\x0c\x08\x08\x88\x08\x08\x0c\x04\x06\x02\x43\xc1'
    b'\x00\x00\x00\x01\x03\x02\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02\x03'
    b'\x00\x00\x00\x00\x00\x00\x00\x0f\x00\x00\x00\x00\x00\x00\x00\x01\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'),
    48, 48, framebuf.MONO_VLSB)

stormy = framebuf.FrameBuffer(bytearray(
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\xc0\xc0\xc0\xc0\xc0\xc0\xc0\xf0\x70\x18\x08\x0c\x0c\x06\x06\x06\x06\x06'
    b'\x06\x0c\x08\x18\x30\xf0\xe0\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x80\xe0\x60\x70\x7e\x03\x03\x01\x00'
    b'\x00\x00\x00\x00\x01\x03\x0f\x7c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\xff\xfc\x80\x80\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\xe0\xfc\x07\x03\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x80\x80\x80\x80\x80\x80\x80'
    b'\x80\x80\x80\x80\x00\x00\x01\x01\x01\x01\x03\x07\x0e\x3c\xf0\x00\x00\x00\x00\x03\x1f\x30\x70\xe0\x80\x80\x80\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x00\x80\xe0\x70\x1e\x03\x01\x01\x01\x01\x61\x71\xfd\xed\xe7\x63\x01\x00\x00\x00\x00\x80\x80\x80\xe0\x70\x3c\x0f\x00'
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x03\x03\x03\x03\xc3\xc3\x03\x03\x03\x07\x07\xc6\xfe\xce\x70\x30\x38\x0c\x0c\x06\x03'
    b'\x03\xc3\x43\x03\x03\x03\x03\x03\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0c\x0f\x03'
    b'\x00\x00\x00\x00\x00\x03\x03\x03\x00\x00\x00\x00\x00\x00\x00\x0e\x0f\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'),
    48, 48, framebuf.MONO_VLSB)

rainy = framebuf.FrameBuffer(bytearray(
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\xc0\xe0\x20\x20\x30\x10\x10\x10\x10\x10\x30'
    b'\x30\x20\x60\xc0\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x80\xc0\x70\x78\x1c\x06\x03\x03\x03'
    b'\x03\x03\x03\x03\x0f\x1d\x78\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x87\xbe\xf8\x00\x00\x00\x00\x00\x00\x00\x00'
    b'\x00\x00\xf0\xf8\x0e\x03\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x00\x00\x01\x01\x01\x01\x03\x06\x0e\xf8\xf0\x00\x00\x00\x00\x00\x03\x0f\x1c\x30\x30\x60\x60\x40\x40\x40\xc0\xc0\x40'
    b'\x40\x40\x40\x40\x40\x40\x40\xc0\xc0\x40\x40\x40\x40\x40\x40\x40\x40\x40\xc0\xc0\x40\x40\x40\x40\x60\x20\x30\x1c\x0f\x03\x00\x00'
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0\xe0\x30\x07\x01\x01\x00\x00\x00\x00\x80\xe0\x70\x00\x07\x03\x00\x00\x00\x00\x00\xc0\xe0'
    b'\x30\x07\x07\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'),
    48, 48, framebuf.MONO_VLSB)

cloudy = framebuf.FrameBuffer(bytearray(
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    b'\xe0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x00\x00\x00\x00\x07\x06\x0c\x80\xc0\x70\x30\x18\x18\x08\x18\x18\x30\x30\x60\xc0\x00\x06\x07\x03\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\xc0\xe0\x60\x60\x60\x60\xe0\xf0\x98\x08\x0c\x04\x04\x04\x04\x07\x0c\x0c\x18\x18\x70'
    b'\xc0\x00\x00\x00\x80\xc0\x7b\x1f\x00\x00\x00\x04\x04\x04\x00\x00\x00\x00\x00\x00\x80\xe0\x70\x18\x08\x0c\x0f\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x07\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x18\x1f\x1f\x33\x61\xe1\xc0\x00\x04\x0c\x18\x18\x00\x00\x00\x00\x00'
    b'\x00\x00\x00\x00\x1f\x3d\x70\xc0\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    b'\x00\x00\x80\xc0\xe0\x3f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x01\x01\x01\x01\x01'
    b'\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'),
    48, 48, framebuf.MONO_VLSB)


oled.blit(sunny, 40, 8)
oled.show()
sleep_ms(1000)

oled.blit(rainy, 40, 8)
oled.show()
sleep_ms(1000)

oled.blit(stormy, 40, 8)
oled.show()
sleep_ms(1000)

oled.blit(cloudy, 40, 8)
oled.show()
sleep_ms(1000)


while True:
    
    p = bmp.get_pressure()
    t = bmp.get_temperature()
    
    oled.fill(oled.BLACK)
    
    if(960 <= p < 980):
        oled.blit(stormy, 75, 8)
        
    elif(980 <= p < 1000):
        oled.blit(rainy, 75, 8)
        
    elif(1000 <= p < 1020):
        oled.blit(cloudy, 75, 8)
    
    elif(1020 <= p < 1070):
        oled.blit(sunny, 75, 8)
        
    oled.text("BMP280", 40, 6, oled.WHITE)
    oled.text("P/mbar:", 6, 18, oled.WHITE)
    oled.text(str("%4.1f" % p), 6, 28, oled.WHITE)
    
    oled.text("T/dg C:", 6, 45, oled.WHITE)
    oled.text(str("%2.2f" % t), 6, 55, oled.WHITE)
    
    oled.show()